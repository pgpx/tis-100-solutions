@0
L:MOV UP,ACC
  JEZ F
  MOV ACC, RIGHT
  SWP
  ADD 1
  SWP
  JMP L
F:SWP
  SUB 8
  NEG
  MOV ACC, DOWN
  MOV 0, ACC
  SAV
  MOV DOWN, NIL#TR

@1
MOV DOWN ACC
!S:JRO ACC
#S:JRO DOWN
  MOV LEFT,DOWN
  MOV LEFT,DOWN
  MOV LEFT,DOWN
  MOV LEFT,DOWN
  MOV LEFT,DOWN
  MOV LEFT,DOWN
  MOV LEFT,DOWN
!  MOV 0, DOWN

@2


@3
S:MOV UP,ACC#CT
L:MOV ACC, RIGHT
  MOV RIGHT, NIL
  JRO ACC
  MOV DOWN, RIGHT
  MOV DOWN, RIGHT
  MOV DOWN, RIGHT
  MOV DOWN, RIGHT
  MOV DOWN, RIGHT
  MOV DOWN, RIGHT
C:SUB 7
  JEZ E
  ADD 8
  JMP L
E:MOV NIL, UP

@4
S:MOV LEFT,ACC#CT
L:MOV ACC, RIGHT
  MOV ACC, DOWN
  MOV RIGHT, LEFT
  JRO ACC
  MOV LEFT, UP
  MOV LEFT, UP
  MOV LEFT, UP
  MOV LEFT, UP
  MOV LEFT, UP
  MOV LEFT, UP
  NOP
#  MOV LEFT, UP

@5
S:MOV LEFT,ACC#CT
  SUB 7
  JNZ V
  MOV -1, DOWN
  JMP S
V:ADD 7
  MOV UP, DOWN#1
L:MOV UP, ACC
  MOV ACC, DOWN
  MOV ACC, DOWN
  JNZ L
!  MOV NIL, LEFT

@6


@7
S:JRO UP
  MOV RIGHT, LEFT#
  MOV RIGHT, LEFT#
 MOV RIGHT, LEFT#
  MOV RIGHT, LEFT#
  MOV RIGHT, LEFT#
  MOV RIGHT, LEFT#

 MOV RIGHT, DOWN#

@8
S:MOV UP, ACC
  JLZ F
L:SAV
  SUB UP
  JGZ G
  MOV UP, LEFT
  SWP
  JMP L
G:SWP
  MOV ACC,LEFT
  MOV UP,ACC
  JNZ L
#Z:MOV 0,LEFT
#  JMP S
